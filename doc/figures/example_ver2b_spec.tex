\begin{lstlisting}[morekeywords={g_qCount},belowskip=0pt, firstnumber=1, name=ver2b]
// dynamically allocated
// arrays, may overlap
int *a, *b, *c;
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt,backgroundcolor=\color{lightgray},
firstnumber=auto, name=ver2b]
check_heap(a, read_only);
check_heap(b, private);
check_heap(c, private);
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt, firstnumber=auto, name=ver2b]

for (int k=0;k<M;k++) {
  for (int i=0;i<N;i++) {
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt,backgroundcolor=\color{lightgray},
firstnumber=auto, name=ver2b]
    spec_write_log(&b[i]);
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt, firstnumber=auto, name=ver2b]
    b[i] = work(a[k][i]); 
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt,backgroundcolor=\color{lightgray},
firstnumber=auto, name=ver2b]
    spec_write_log(&c[k][i]);
\end{lstlisting}

\begin{lstlisting}[aboveskip=0pt,belowskip=0pt, firstnumber=auto, name=ver2b]
    c[k][i] = b[i];    
  }
}
\end{lstlisting}
