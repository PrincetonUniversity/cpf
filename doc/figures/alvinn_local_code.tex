\begin{lstlisting}[morekeywords={psum_array},belowskip=0pt]
float psum_array[NHU+1]; // stack

for (epoch = 0; epoch < NUM_EPOCHS; epoch++) {
  ...
  for ( i = 0; i < NHU+1; i++ )
    psum_array[i] = 0;
  for( i = 0; i < NOU; i++ ) {
    for ( j = 0; j < NHU+1; j++ ) {
      ...
      psum_array[j] += delta[i] * weights[i][j];
      ...
    }
  }
  for ( i = 0; i < NHU+1; i++ )
    delta[i] = hidden[i] * (1 - hidden[i]) * psum_array[i];
  ...
}
\end{lstlisting}
